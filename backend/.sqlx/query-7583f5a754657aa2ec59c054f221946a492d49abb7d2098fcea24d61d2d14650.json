{
  "db_name": "PostgreSQL",
  "query": "\n        INSERT INTO ad_performance_by_location (ad_id, country, city, impressions)\n        VALUES ($1, $2, COALESCE($3, ''), 1)\n        ON CONFLICT (ad_id, country, city) DO UPDATE\n        SET impressions = ad_performance_by_location.impressions + 1,\n            ctr = CASE\n                WHEN ad_performance_by_location.impressions + 1 > 0\n                THEN (ad_performance_by_location.clicks::DECIMAL / (ad_performance_by_location.impressions + 1)) * 100\n                ELSE 0\n            END,\n            last_updated = NOW()\n        ",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": [
        "Uuid",
        "Varchar",
        "Text"
      ]
    },
    "nullable": []
  },
  "hash": "7583f5a754657aa2ec59c054f221946a492d49abb7d2098fcea24d61d2d14650"
}
